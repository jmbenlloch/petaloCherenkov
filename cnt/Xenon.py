"""
Xenon
Properties of Xenon
"""
from Centella.physical_constants import *
from Util import *
import sys


nm = nanometer 
mol = mole
micron = micrometer

#Photon   ,Coherent,Incoher.,Photoel.,Nuclear ,Electron,Tot. w/ ,
#Energy   ,Scatter.,Scatter.,Absorb. ,Pr. Prd.,Pr. Prd.,Coherent,

Xe={
1.000E-03:[8.458E+00,4.417E-03,9.403E+03,0.000E+00,0.000E+00,9.412E+03],
1.072E-03:[8.393E+00,4.969E-03,8.133E+03,0.000E+00,0.000E+00,8.141E+03],
1.149E-03:[8.325E+00,5.582E-03,7.032E+03,0.000E+00,0.000E+00,7.040E+03],
1.149E-03:[8.325E+00,5.582E-03,7.334E+03,0.000E+00,0.000E+00,7.343E+03],
1.500E-03:[8.000E+00,8.522E-03,4.077E+03,0.000E+00,0.000E+00,4.085E+03],
2.000E-03:[7.481E+00,1.285E-02,2.080E+03,0.000E+00,0.000E+00,2.088E+03],
3.000E-03:[6.481E+00,2.123E-02,7.715E+02,0.000E+00,0.000E+00,7.780E+02],
4.000E-03:[5.637E+00,2.874E-02,3.730E+02,0.000E+00,0.000E+00,3.787E+02],
4.782E-03:[5.087E+00,3.383E-02,2.357E+02,0.000E+00,0.000E+00,2.408E+02],
4.782E-03:[5.087E+00,3.383E-02,6.890E+02,0.000E+00,0.000E+00,6.941E+02],
5.000E-03:[4.945E+00,3.515E-02,6.344E+02,0.000E+00,0.000E+00,6.393E+02],
5.104E-03:[4.880E+00,3.577E-02,5.995E+02,0.000E+00,0.000E+00,6.044E+02],
5.104E-03:[4.880E+00,3.577E-02,8.133E+02,0.000E+00,0.000E+00,8.182E+02],
5.275E-03:[4.775E+00,3.677E-02,7.515E+02,0.000E+00,0.000E+00,7.563E+02],
5.453E-03:[4.669E+00,3.777E-02,6.945E+02,0.000E+00,0.000E+00,6.992E+02],
5.453E-03:[4.669E+00,3.777E-02,8.018E+02,0.000E+00,0.000E+00,8.065E+02],
6.000E-03:[4.368E+00,4.071E-02,6.330E+02,0.000E+00,0.000E+00,6.374E+02],
8.000E-03:[3.464E+00,5.027E-02,2.998E+02,0.000E+00,0.000E+00,3.033E+02],
1.000E-02:[2.815E+00,5.848E-02,1.662E+02,0.000E+00,0.000E+00,1.691E+02],
1.500E-02:[1.852E+00,7.440E-02,5.550E+01,0.000E+00,0.000E+00,5.743E+01],
2.000E-02:[1.322E+00,8.486E-02,2.510E+01,0.000E+00,0.000E+00,2.651E+01],
3.000E-02:[7.545E-01,9.729E-02,8.078E+00,0.000E+00,0.000E+00,8.929E+00],
3.456E-02:[6.119E-01,1.008E-01,5.417E+00,0.000E+00,0.000E+00,6.130E+00],
3.456E-02:[6.119E-01,1.008E-01,3.244E+01,0.000E+00,0.000E+00,3.316E+01],
4.000E-02:[4.913E-01,1.038E-01,2.211E+01,0.000E+00,0.000E+00,2.270E+01],
5.000E-02:[3.492E-01,1.073E-01,1.227E+01,0.000E+00,0.000E+00,1.273E+01],
6.000E-02:[2.610E-01,1.091E-01,7.454E+00,0.000E+00,0.000E+00,7.824E+00],
8.000E-02:[1.608E-01,1.096E-01,3.363E+00,0.000E+00,0.000E+00,3.633E+00],
1.000E-01:[1.089E-01,1.081E-01,1.793E+00,0.000E+00,0.000E+00,2.010E+00],
1.500E-01:[5.298E-02,1.019E-01,5.651E-01,0.000E+00,0.000E+00,7.200E-01],
2.000E-01:[3.136E-02,9.555E-02,2.490E-01,0.000E+00,0.000E+00,3.759E-01],
3.000E-01:[1.464E-02,8.495E-02,8.009E-02,0.000E+00,0.000E+00,1.797E-01],
4.000E-01:[8.435E-03,7.688E-02,3.699E-02,0.000E+00,0.000E+00,1.223E-01],
5.000E-01:[5.472E-03,7.064E-02,2.088E-02,0.000E+00,0.000E+00,9.699E-02],
6.000E-01:[3.837E-03,6.559E-02,1.338E-02,0.000E+00,0.000E+00,8.281E-02],
8.000E-01:[2.181E-03,5.784E-02,6.940E-03,0.000E+00,0.000E+00,6.696E-02],
1.000E+00:[1.404E-03,5.211E-02,4.335E-03,0.000E+00,0.000E+00,5.785E-02],
1.022E+00:[1.345E-03,5.156E-02,4.126E-03,0.000E+00,0.000E+00,5.703E-02],
1.250E+00:[9.022E-04,4.665E-02,2.782E-03,1.914E-04,0.000E+00,5.052E-02],
1.500E+00:[6.279E-04,4.244E-02,1.991E-03,8.853E-04,0.000E+00,4.594E-02],
2.000E+00:[3.540E-04,3.625E-02,1.211E-03,2.971E-03,0.000E+00,4.078E-02],
2.044E+00:[3.390E-04,3.580E-02,1.169E-03,3.173E-03,0.000E+00,4.048E-02],
3.000E+00:[1.576E-04,2.854E-02,6.422E-04,7.458E-03,9.981E-06,3.681E-02],
4.000E+00:[8.871E-05,2.381E-02,4.250E-04,1.141E-02,4.070E-05,3.577E-02],
5.000E+00:[5.679E-05,2.057E-02,3.142E-04,1.481E-02,8.100E-05,3.583E-02],
6.000E+00:[3.944E-05,1.818E-02,2.478E-04,1.774E-02,1.243E-04,3.634E-02],
7.000E+00:[2.898E-05,1.634E-02,2.040E-04,2.035E-02,1.674E-04,3.709E-02],
8.000E+00:[2.219E-05,1.488E-02,1.731E-04,2.269E-02,2.091E-04,3.797E-02],
9.000E+00:[1.754E-05,1.367E-02,1.501E-04,2.482E-02,2.489E-04,3.891E-02],
1.000E+01:[1.420E-05,1.267E-02,1.324E-04,2.677E-02,2.868E-04,3.987E-02],
}


XeSpectrum=[
[6.40625e-06, 0.0964027],
[6.41025e-06, 0.100438],
[6.41425e-06, 0.104612],
[6.41825e-06, 0.108926],
[6.42225e-06, 0.113386],
[6.42625e-06, 0.117993],
[6.43025e-06, 0.122752],
[6.43425e-06, 0.127664],
[6.43825e-06, 0.132734],
[6.44225e-06, 0.137965],
[6.44625e-06, 0.14336],
[6.45025e-06, 0.148922],
[6.45425e-06, 0.154654],
[6.45825e-06, 0.16056],
[6.46225e-06, 0.166642],
[6.46625e-06, 0.172903],
[6.47025e-06, 0.179347],
[6.47425e-06, 0.185977],
[6.47825e-06, 0.192794],
[6.48225e-06, 0.199803],
[6.48625e-06, 0.207005],
[6.49025e-06, 0.214404],
[6.49425e-06, 0.222003],
[6.49825e-06, 0.229802],
[6.50225e-06, 0.237806],
[6.50625e-06, 0.246016],
[6.51025e-06, 0.254435],
[6.51425e-06, 0.263064],
[6.51825e-06, 0.271906],
[6.52225e-06, 0.280962],
[6.52625e-06, 0.290235],
[6.53025e-06, 0.299725],
[6.53425e-06, 0.309434],
[6.53825e-06, 0.319364],
[6.54225e-06, 0.329516],
[6.54625e-06, 0.33989],
[6.55025e-06, 0.350487],
[6.55425e-06, 0.361309],
[6.55825e-06, 0.372355],
[6.56225e-06, 0.383626],
[6.56625e-06, 0.395121],
[6.57025e-06, 0.406842],
[6.57425e-06, 0.418786],
[6.57825e-06, 0.430955],
[6.58225e-06, 0.443346],
[6.58625e-06, 0.45596],
[6.59025e-06, 0.468794],
[6.59425e-06, 0.481848],
[6.59825e-06, 0.495119],
[6.60225e-06, 0.508607],
[6.60625e-06, 0.522307],
[6.61025e-06, 0.536219],
[6.61425e-06, 0.55034],
[6.61825e-06, 0.564666],
[6.62225e-06, 0.579194],
[6.62625e-06, 0.593922],
[6.63025e-06, 0.608844],
[6.63425e-06, 0.623958],
[6.63825e-06, 0.639259],
[6.64225e-06, 0.654742],
[6.64625e-06, 0.670403],
[6.65025e-06, 0.686236],
[6.65425e-06, 0.702237],
[6.65825e-06, 0.718399],
[6.66225e-06, 0.734716],
[6.66625e-06, 0.751183],
[6.67025e-06, 0.767793],
[6.67425e-06, 0.78454],
[6.67825e-06, 0.801415],
[6.68225e-06, 0.818413],
[6.68625e-06, 0.835525],
[6.69025e-06, 0.852744],
[6.69425e-06, 0.870062],
[6.69825e-06, 0.88747],
[6.70225e-06, 0.904959],
[6.70625e-06, 0.922522],
[6.71025e-06, 0.940149],
[6.71425e-06, 0.95783],
[6.71825e-06, 0.975557],
[6.72225e-06, 0.99332],
[6.72625e-06, 1.01111],
[6.73025e-06, 1.02891],
[6.73425e-06, 1.04672],
[6.73825e-06, 1.06452],
[6.74225e-06, 1.08231],
[6.74625e-06, 1.10007],
[6.75025e-06, 1.1178],
[6.75425e-06, 1.13547],
[6.75825e-06, 1.15309],
[6.76225e-06, 1.17063],
[6.76625e-06, 1.18809],
[6.77025e-06, 1.20546],
[6.77425e-06, 1.22272],
[6.77825e-06, 1.23986],
[6.78225e-06, 1.25687],
[6.78625e-06, 1.27374],
[6.79025e-06, 1.29046],
[6.79425e-06, 1.30701],
[6.79825e-06, 1.32338],
[6.80225e-06, 1.33957],
[6.80625e-06, 1.35555],
[6.81025e-06, 1.37132],
[6.81425e-06, 1.38687],
[6.81825e-06, 1.40217],
[6.82225e-06, 1.41723],
[6.82625e-06, 1.43204],
[6.83025e-06, 1.44656],
[6.83425e-06, 1.46081],
[6.83825e-06, 1.47476],
[6.84225e-06, 1.48841],
[6.84625e-06, 1.50174],
[6.85025e-06, 1.51475],
[6.85425e-06, 1.52742],
[6.85825e-06, 1.53974],
[6.86225e-06, 1.5517],
[6.86625e-06, 1.5633],
[6.87025e-06, 1.57451],
[6.87425e-06, 1.58535],
[6.87825e-06, 1.59578],
[6.88225e-06, 1.60582],
[6.88625e-06, 1.61544],
[6.89025e-06, 1.62464],
[6.89425e-06, 1.63341],
[6.89825e-06, 1.64174],
[6.90225e-06, 1.64963],
[6.90625e-06, 1.65708],
[6.91025e-06, 1.66406],
[6.91425e-06, 1.67058],
[6.91825e-06, 1.67664],
[6.92225e-06, 1.68222],
[6.92625e-06, 1.68732],
[6.93025e-06, 1.69194],
[6.93425e-06, 1.69608],
[6.93825e-06, 1.69972],
[6.94225e-06, 1.70287],
[6.94625e-06, 1.70552],
[6.95025e-06, 1.70768],
[6.95425e-06, 1.70933],
[6.95825e-06, 1.71048],
[6.96225e-06, 1.71113],
[6.96625e-06, 1.71128],
[6.97025e-06, 1.71092],
[6.97425e-06, 1.71006],
[6.97825e-06, 1.70869],
[6.98225e-06, 1.70683],
[6.98625e-06, 1.70446],
[6.99025e-06, 1.7016],
[6.99425e-06, 1.69824],
[6.99825e-06, 1.69439],
[7.00225e-06, 1.69005],
[7.00625e-06, 1.68522],
[7.01025e-06, 1.67992],
[7.01425e-06, 1.67413],
[7.01825e-06, 1.66788],
[7.02225e-06, 1.66116],
[7.02625e-06, 1.65398],
[7.03025e-06, 1.64635],
[7.03425e-06, 1.63827],
[7.03825e-06, 1.62975],
[7.04225e-06, 1.6208],
[7.04625e-06, 1.61142],
[7.05025e-06, 1.60162],
[7.05425e-06, 1.59142],
[7.05825e-06, 1.58081],
[7.06225e-06, 1.56981],
[7.06625e-06, 1.55843],
[7.07025e-06, 1.54668],
[7.07425e-06, 1.53457],
[7.07825e-06, 1.5221],
[7.08225e-06, 1.50929],
[7.08625e-06, 1.49614],
[7.09025e-06, 1.48268],
[7.09425e-06, 1.4689],
[7.09825e-06, 1.45482],
[7.10225e-06, 1.44045],
[7.10625e-06, 1.42581],
[7.11025e-06, 1.41089],
[7.11425e-06, 1.39573],
[7.11825e-06, 1.38032],
[7.12225e-06, 1.36467],
[7.12625e-06, 1.34881],
[7.13025e-06, 1.33274],
[7.13425e-06, 1.31648],
[7.13825e-06, 1.30003],
[7.14225e-06, 1.2834],
[7.14625e-06, 1.26662],
[7.15025e-06, 1.24969],
[7.15425e-06, 1.23262],
[7.15825e-06, 1.21543],
[7.16225e-06, 1.19812],
[7.16625e-06, 1.18071],
[7.17025e-06, 1.16322],
[7.17425e-06, 1.14564],
[7.17825e-06, 1.128],
[7.18225e-06, 1.1103],
[7.18625e-06, 1.09256],
[7.19025e-06, 1.07479],
[7.19425e-06, 1.05699],
[7.19825e-06, 1.03919],
[7.20225e-06, 1.02138],
[7.20625e-06, 1.00358],
[7.21025e-06, 0.985801],
[7.21425e-06, 0.968052],
[7.21825e-06, 0.950343],
[7.22225e-06, 0.932684],
[7.22625e-06, 0.915083],
[7.23025e-06, 0.89755],
[7.23425e-06, 0.880094],
[7.23825e-06, 0.862723],
[7.24225e-06, 0.845446],
[7.24625e-06, 0.828272],
[7.25025e-06, 0.811207],
[7.25425e-06, 0.79426],
[7.25825e-06, 0.777438],
[7.26225e-06, 0.760749],
[7.26625e-06, 0.744198],
[7.27025e-06, 0.727794],
[7.27425e-06, 0.711541],
[7.27825e-06, 0.695447],
[7.28225e-06, 0.679516],
[7.28625e-06, 0.663755],
[7.29025e-06, 0.648169],
[7.29425e-06, 0.632762],
[7.29825e-06, 0.61754],
[7.30225e-06, 0.602507],
[7.30625e-06, 0.587666],
[7.31025e-06, 0.573023],
[7.31425e-06, 0.55858],
[7.31825e-06, 0.54434],
[7.32225e-06, 0.530307],
[7.32625e-06, 0.516485],
[7.33025e-06, 0.502874],
[7.33425e-06, 0.489478],
[7.33825e-06, 0.476298],
[7.34225e-06, 0.463337],
[7.34625e-06, 0.450596],
[7.35025e-06, 0.438076],
[7.35425e-06, 0.425779],
[7.35825e-06, 0.413705],
[7.36225e-06, 0.401855],
[7.36625e-06, 0.39023],
[7.37025e-06, 0.37883],
[7.37425e-06, 0.367654],
[7.37825e-06, 0.356703],
[7.38225e-06, 0.345976],
[7.38625e-06, 0.335473],
[7.39025e-06, 0.325193],
[7.39425e-06, 0.315136],
[7.39825e-06, 0.305299],
[7.40225e-06, 0.295683],
[7.40625e-06, 0.286285],
[7.41025e-06, 0.277104],
[7.41425e-06, 0.268139],
[7.41825e-06, 0.259387],
[7.42225e-06, 0.250847],
[7.42625e-06, 0.242517],
[7.43025e-06, 0.234395],
[7.43425e-06, 0.226477],
[7.43825e-06, 0.218763],
[7.44225e-06, 0.21125],
[7.44625e-06, 0.203934],
[7.45025e-06, 0.196814],
[7.45425e-06, 0.189886],
[7.45825e-06, 0.183149],
[7.46225e-06, 0.176598],
[7.46625e-06, 0.170232],
[7.47025e-06, 0.164047],
[7.47425e-06, 0.15804],
[7.47825e-06, 0.152208],
[7.48225e-06, 0.146548],
[7.48625e-06, 0.141057],
[7.49025e-06, 0.135732],
[7.49425e-06, 0.13057],
[7.49825e-06, 0.125567],
[7.50225e-06, 0.12072],
[7.50625e-06, 0.116026],
[7.51025e-06, 0.111481],
[7.51425e-06, 0.107083],
[7.51825e-06, 0.102829],
[7.52225e-06, 0.098714]
]



def selectE(E):
  """
  Select the key closest to the energy E
  """
  dE=999999.
  EE = -999999.

  #print "selectE: E = ", E/MeV
  for key in Xe.keys():
    diff=abs(E - key)
    if diff < dE:
      dE=diff
      EE=key 

  #print "EE =",EE
  return EE

def ScatterCoherent(E):
  """
  cross section due to coherent scattering
  """
  return Xe[selectE(E/MeV)][0]*cm2/g

def ScatterIncoherent(E):
  """
  cross section  due to incoherent scattering
  """
  return Xe[selectE(E/MeV)][1]*cm2/g

def Photoelectric(E):
  """
  cross section  due to photoelectric
  """
  return Xe[selectE(E/MeV)][2]*cm2/g

def PairNuclearFied(E):
  """
  cross section  due to pairs in nuclear field
  """
  return Xe[selectE(E/MeV)][3]*cm2/g
  
def PairElectronField(E):
  """
  cross section  due to pairs in electron field
  """
  return Xe[selectE(E/MeV)][4]*cm2/g
  
def TotalInteraction(E):
  """
   Total cross section 
    """ 
  return Xe[selectE(E/MeV)][5]*cm2/g  

def TransmittedBeam(E,Z,rho):
  """
  Transmitted beam of energy z through a thickness Z
  rho is the density
  """
  mu_over_rho =TotalInteraction(E)

  # print "mu_over_rho = %7.4g (cm2/g)"%(mu_over_rho/(cm2/g))
  # print "rho = %7.4g (g/cm3)"%(self.rho/(g/cm3))
  # print "z = %7.4g (cm)"%(Z/cm)
  # print "mu_over_rho*rho*z = %7.4g"%(mu_over_rho*self.rho*Z)
  # print "exp(-mu_over_rho*rho*z) = %7.4g"%(exp(-mu_over_rho*self.rho*Z))
  return exp(-mu_over_rho*Z*rho)

def InteractionFraction(E,Z,rho):
  """
  Fraction of gammas of energy E interacting in thickness E
  """
  return 1. - TransmittedBeam(E, Z,rho)
    
    
